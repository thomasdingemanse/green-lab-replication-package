(window.webpackJsonp=window.webpackJsonp||[]).push([["financial-times-o-cookie-message"],{"3108efc0":function(e,o,t){"use strict";t.r(o);class s{constructor(e,o){null==e&&(e=document.createElement("div"),document.body.append(e)),this.cookieMessageElement=e,this._eventListeners=[],o=o||s.getOptionsFromDom(e),this.options=Object.assign({},o),this.options.theme=this.options.theme?"alternative":null,this.cookieInfo=this.getCookieInfo(),this.shouldShowCookieMessage()?(this.createCookieMessage(),this.showCookieMessage()):this.removeCookieMessage();const t=e=>{if(!0===e.persisted&&!1===this.shouldShowCookieMessage())return this.removeCookieMessage()};window.addEventListener("pageshow",t),this._eventListeners.push({target:window,type:"pageshow",listener:t})}getCookieInfo(){let e="ft.com",o="preferences/manage-cookies";/\.ft\.com$/i.test(window.location.hostname)||(e=window.location.hostname.replace(/^(.*?)\./,""),o="preferences/cookies"),"string"==typeof this.options.manageCookiesPath&&(o=this.options.manageCookiesPath);const t=window.location.href;return{acceptUrl:`https://consent.${e}/__consent/consent-record-cookie?cookieDomain=.${e}`,acceptUrlFallback:`https://consent.${e}/__consent/consent-record-cookie?redirect=${t}&cookieDomain=.${e}`,manageCookiesUrl:`https://cookies.${e}/${o}?redirect=${t}&cookieDomain=.${e}`,consentCookieName:"FTCookieConsentGDPR"}}createCookieMessage(){const e=e=>`\n<div class="o-cookie-message__outer">\n\t<div class="o-cookie-message__inner">\n\t\t<div class="o-cookie-message__content">\n\t\t\t\t${e}\n\t\t</div>\n\t\t<div class="o-cookie-message__actions">\n\n\t\t\t<div class="o-cookie-message__action">\n\t\t\t\t<a href="${this.cookieInfo.acceptUrlFallback}" class="o-cookie-message__button">\n\t\t\t\t\tAccept &amp; continue\n\t\t\t\t</a>\n\t\t\t</div>\n\n\t\t\t<div class="o-cookie-message__action o-cookie-message__action--secondary">\n\t\t\t\t<a href="${this.cookieInfo.manageCookiesUrl}" class="o-cookie-message__link">Manage cookies</a>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>`,o="o-cookie-message-label",t=`\n<div class="o-cookie-message__heading">\n\t<h2 id="${o}">Cookies on the FT</h2>\n</div>\n<p id="o-cookie-message-description">\n\tWe use <a href="http://help.ft.com/help/legal-privacy/cookies/" class="o-cookie-message__link" target="_blank" rel="noopener">cookies</a> for a number of reasons, such as keeping FT Sites reliable and secure, personalising content and ads, providing social media features and to analyse how our Sites are used.\n</p>`,s=this.cookieMessageElement.firstElementChild,i=this.cookieMessageElement.innerHTML;s&&s.classList.contains("o-cookie-message__outer")||(""===i.trim()?(this.cookieMessageElement.innerHTML=e(t),this.cookieMessageElement.setAttribute("role","dialog"),this.cookieMessageElement.setAttribute("aria-labelledby",o),this.cookieMessageElement.setAttribute("aria-describedby","o-cookie-message-description")):this.cookieMessageElement.innerHTML=e(i))}updateConsent(){const e=document.querySelector(".o-cookie-message__button");if(e){const o=e=>(e.preventDefault(),this.dispatchEvent("oCookieMessage.act"),this.removeCookieMessage(),fetch(this.cookieInfo.acceptUrl,{method:"get",credentials:"include"}));e.addEventListener("click",o),this._eventListeners.push({target:e,type:"click",listener:o})}}shouldShowCookieMessage(){return!document.cookie.includes(""+this.cookieInfo.consentCookieName)}showCookieMessage(){this.cookieMessageElement.classList.add("o-cookie-message","o-cookie-message--active"),this.options.theme&&this.cookieMessageElement.classList.add("o-cookie-message--"+this.options.theme),this.dispatchEvent("oCookieMessage.view"),this.updateConsent()}removeCookieMessage(){this.dispatchEvent("oCookieMessage.close");try{this.cookieMessageElement.parentNode.removeChild(this.cookieMessageElement)}catch(e){}}destroy(){this.cookieMessageElement.classList.remove("o-cookie-message--"+this.options.theme),this._eventListeners.forEach(e=>{const{target:o,type:t,listener:s}=e;o.removeEventListener(t,s)})}dispatchEvent(e){const o=new CustomEvent(e,{bubbles:!0});this.cookieMessageElement.dispatchEvent(o)}static getOptionsFromDom(e){return e instanceof HTMLElement?Object.keys(e.dataset).reduce((o,t)=>{if("oComponent"===t)return o;const s=t.replace(/^oCookieMessage(\w)(\w+)$/,(e,o,t)=>o.toLowerCase()+t),i=e.dataset[t];try{o[s]=JSON.parse(i.replace(/\'/g,'"'))}catch(e){o[s]=i}return o},{}):{}}static init(e,o){if(e||(e=document.body),e instanceof HTMLElement||(e=document.querySelector(e)),e instanceof HTMLElement&&/\bo-cookie-message\b/.test(e.getAttribute("data-o-component")))return new s(e,o);const t=e.querySelector('[data-o-component="o-cookie-message"]');return new s(t,o)}}var i=s;"undefined"!=typeof document&&document.addEventListener("o.DOMContentLoaded",(function e(){i.init(),document.removeEventListener("o.DOMContentLoaded",e)}));o.default=i}}]);
//# sourceMappingURL=financial-times-o-cookie-message.672c394b98fb.bundle.js.map